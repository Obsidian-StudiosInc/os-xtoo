From 5c017544f69c9754e8eaaef785ddf318df5dcd7f Mon Sep 17 00:00:00 2001
From: BJ Hargrave <bj@bjhargrave.com>
Date: Fri, 13 Jul 2018 11:44:24 -0400
Subject: [PATCH] resolve: Update to Felix Resolver 2.0

This requires using the OSGi resolver 1.1 package.

Signed-off-by: BJ Hargrave <bj@bjhargrave.com>
---
 .../src/biz/aQute/resolve/BndResolver.java             | 10 +++++++++-

diff --git a/src/biz/aQute/resolve/BndResolver.java b/src/biz/aQute/resolve/BndResolver.java
index b25273317..580dd9461 100644
--- a/src/biz/aQute/resolve/BndResolver.java
+++ b/src/biz/aQute/resolve/BndResolver.java
@@ -5,8 +5,10 @@
 
 import org.apache.felix.resolver.Logger;
 import org.apache.felix.resolver.ResolverImpl;
+import org.osgi.resource.Requirement;
 import org.osgi.resource.Resource;
 import org.osgi.resource.Wire;
+import org.osgi.resource.Wiring;
 import org.osgi.service.resolver.ResolutionException;
 import org.osgi.service.resolver.ResolveContext;
 import org.osgi.service.resolver.Resolver;
@@ -18,7 +20,7 @@
 	private final Resolver resolver;
 
 	public BndResolver(ResolverLogger logger) {
-		resolver = new ResolverImpl(new InternalResolverLogger(logger), Processor.getExecutor());
+		this(new InternalResolverLogger(logger));
 	}
 
 	public BndResolver(Logger logger) {
@@ -29,4 +31,10 @@ public BndResolver(Logger logger) {
 	public Map<Resource, List<Wire>> resolve(ResolveContext resolveContext) throws ResolutionException {
 		return resolver.resolve(resolveContext);
 	}
+
+	@Override
+	public Map<Resource, List<Wire>> resolveDynamic(ResolveContext context, Wiring hostWiring,
+		Requirement dynamicRequirement) throws ResolutionException {
+		return resolver.resolveDynamic(context, hostWiring, dynamicRequirement);
+	}
 }

